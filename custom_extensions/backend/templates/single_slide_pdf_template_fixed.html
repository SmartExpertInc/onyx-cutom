<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Single Slide PDF - Fixed</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@400;600;700&family=Martel+Sans:wght@400;600;700&family=Inter:wght@400;500;600;700&family=Roboto:wght@400;500;700&family=Montserrat:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        /* Mont Font Family - Embedded Base64 Fonts for PDF Rendering */
        {{ embedded_fonts_css|safe }}
        
        /* Reset and base styles */
        html, body {
            margin: 0;
            padding: 0;
            background: transparent;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Martel Sans', sans-serif;
            line-height: 1.6;
            color: #333;
        }
        
        /* Dynamic page setup for PDF - HEIGHT IS SET BY PYTHON */
        @page {
            size: 1174px {{ slide_height }}px; /* Dynamic height from Python */
            margin: 0;
            padding: 0;
        }
        
        /* Single slide container - EXACT FRONTEND MATCH */
        .slide-page {
            width: 1174px;
            height: {{ slide_height }}px; /* Dynamic height from Python */
            min-height: {{ slide_height }}px;
            max-height: {{ slide_height }}px;
            position: relative;
            overflow: visible; /* Allow content to determine height */
            margin: 0;
            padding: 0;
            background: transparent;
            display: block;
        }
        
        /* Dynamic positioning support for PDF */
        .positioned-element {
            position: absolute;
            z-index: 1;
        }
        
        /* Hide empty content in PDF */
        .hide-if-empty:empty {
            display: none !important;
        }
        
        /* Hide elements with only placeholder text */
        .hide-placeholder {
            display: none !important;
        }
        
        /* Dynamic positioning container */
        .slide-content {
            width: 100%;
            height: 100%; /* Fill the page height */
            padding: 0;
            margin: 0;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            background: transparent;
            position: relative; /* Enable absolute positioning for children */
        }
        
        /* Theme color definitions - EXACT FRONTEND MATCH */
        .theme-dark-purple {
            --bg-color: #110c35;
            --title-color: #ffffff;
            --subtitle-color: #d9e1ff;
            --content-color: #d9e1ff;
            --accent-color: #f35657;
            --title-font: 'Kanit', sans-serif;
            --content-font: 'Martel Sans', sans-serif;
            --title-size: 45px;
            --content-size: 18px;
        }
        
        .theme-light-modern {
            --bg-color: #ffffff;
            --title-color: #1a1a1a;
            --subtitle-color: #333333;
            --content-color: #666666;
            --accent-color: #007bff;
            --title-font: 'Inter', sans-serif;
            --content-font: 'Inter', sans-serif;
            --title-size: 42px;
            --content-size: 16px;
        }
        
        .theme-dark-blue {
            --bg-color: #0a1929;
            --title-color: #ffffff;
            --subtitle-color: #b2bac2;
            --content-color: #b2bac2;
            --accent-color: #00bcd4;
            --title-font: 'Montserrat', sans-serif;
            --content-font: 'Montserrat', sans-serif;
            --title-size: 44px;
            --content-size: 17px;
        }
        
        .theme-light-cream {
            --bg-color: #faf8f3;
            --title-color: #2c1810;
            --subtitle-color: #5a4a42;
            --content-color: #5a4a42;
            --accent-color: #d4a574;
            --title-font: 'Martel Sans', sans-serif;
            --content-font: 'Martel Sans', sans-serif;
            --title-size: 43px;
            --content-size: 16px;
        }
        
        .theme-dark-green {
            --bg-color: #0d1b2a;
            --title-color: #ffffff;
            --subtitle-color: #a8dadc;
            --content-color: #a8dadc;
            --accent-color: #06ffa5;
            --title-font: 'Kanit', sans-serif;
            --content-font: 'Martel Sans', sans-serif;
            --title-size: 45px;
            --content-size: 18px;
        }
        
        /* FIXED: Image with transform support - ADDED !important */
        .transformed-image {
            position: relative !important;
            display: block !important;
            max-width: none !important;
            max-height: none !important;
            border-radius: 8px !important;
        }
        
        /* Support for different crop modes */
        .crop-cover {
            object-fit: cover !important;
        }
        
        .crop-contain {
            object-fit: contain !important;
        }
        
        .crop-fill {
            object-fit: fill !important;
        }
        
        /* Enhanced positioning for draggable elements */
        .draggable-element {
            position: absolute !important;
            z-index: 1 !important;
        }
        
        /* Slide content with positioning support */
        .slide-content-positioned {
            position: relative !important;
            width: 100% !important;
            height: 100% !important;
            overflow: visible !important;
        }
        
        /* Image size variants */
        .image-size-small {
            width: 200px !important;
            height: 150px !important;
        }
        
        .image-size-medium {
            width: 300px !important;
            height: 200px !important;
        }
        
        .image-size-large {
            width: 400px !important;
            height: 300px !important;
        }
        
        /* Image position variants */
        .image-position-left {
            justify-self: start !important;
            align-self: center !important;
        }
        
        .image-position-right {
            justify-self: end !important;
            align-self: center !important;
        }
        
        .image-position-center {
            justify-self: center !important;
            align-self: center !important;
        }
        
        .image-position-background {
            position: absolute !important;
            top: 0 !important;
            left: 0 !important;
            width: 100% !important;
            height: 100% !important;
            z-index: -1 !important;
            opacity: 0.2 !important;
        }

    </style>
</head>
<body>
    <div class="slide-page">
        <div class="slide-content theme-{{ theme or 'dark-purple' }}">
            {% if slide.templateId == 'bullet-points' %}
                <div class="bullet-points">
                    <div class="image-container">
                        {% if slide.props.imagePath %}
                            <div class="image-positioning-container" style="
                                width: {{ (slide.props.widthPx|string + 'px') if slide.props.widthPx else '320px' }};
                                height: {{ (slide.props.heightPx|string + 'px') if slide.props.heightPx else '320px' }};
                                position: relative;
                                overflow: hidden;
                                border-radius: 8px;
                                {% if slide.metadata and slide.metadata.elementPositions %}
                                    {% set imageId = 'draggable-' + slide.slideId + '-image' %}
                                    {% if slide.metadata.elementPositions[imageId] %}
                                        transform: translate({{ slide.metadata.elementPositions[imageId].x }}px, {{ slide.metadata.elementPositions[imageId].y }}px) !important;
                                    {% endif %}
                                {% endif %}
                            ">
                                <img src="{{ slide.props.imagePath }}" 
                                     alt="Uploaded image" 
                                     class="transformed-image"
                                     style="
                                        width: 100%;
                                        height: 100%;
                                        object-fit: {{ slide.props.objectFit if slide.props.objectFit else 'cover' }};
                                        {% if slide.props.imageOffset %}
                                            {% if slide.props.imageScale and slide.props.imageScale != 1 %}
                                                transform: translate({{ (slide.props.imageOffset.x|string + 'px') if slide.props.imageOffset.x is not none else '0px' }}, {{ (slide.props.imageOffset.y|string + 'px') if slide.props.imageOffset.y is not none else '0px' }}) scale({{ slide.props.imageScale }}) !important;
                                            {% else %}
                                                transform: translate({{ (slide.props.imageOffset.x|string + 'px') if slide.props.imageOffset.x is not none else '0px' }}, {{ (slide.props.imageOffset.y|string + 'px') if slide.props.imageOffset.y is not none else '0px' }}) !important;
                                            {% endif %}
                                            transform-origin: center center !important;
                                        {% endif %}
                                        border-radius: 8px;
                                        margin: 0;
                                        max-width: none;
                                        max-height: none;
                                     "
                                     onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';" />
                            </div>
                            <div class="image-placeholder" style="display: none;">
                                <div style="font-size: 48px; margin-bottom: 16px;">üñºÔ∏è</div>
                                <div style="font-size: 16px; font-weight: bold; margin-bottom: 8px;">Image Placeholder</div>
                                <div style="font-size: 14px; font-style: italic; margin-bottom: 12px;">AI Prompt: "{{ slide.props.imagePrompt or slide.props.imageAlt or 'A relevant illustration for the bullet points' }}"</div>
                                <div style="font-size: 12px; color: #868e96;">320px √ó 320px</div>
                            </div>
                        {% else %}
                            <div class="image-placeholder" style="width: 320px; height: 320px; display: flex; align-items: center; justify-content: center; border: 2px dashed #e0e0e0; border-radius: 8px; background-color: #f8f9fa;">
                                <!-- Empty placeholder - maintains layout -->
                            </div>
                        {% endif %}
                    </div>
                    <div class="content-container">
                        {% if slide.props.title and slide.props.title != 'Click to add title' and slide.props.title != 'Add title' %}
                            <h1 class="slide-title positioned-element"
                                {% if slide.metadata and slide.metadata.elementPositions %}
                                    {% set titleId = 'draggable-' + slide.slideId + '-0' %}
                                    {% if slide.metadata.elementPositions[titleId] %}
                                        style="transform: translate({{ slide.metadata.elementPositions[titleId].x }}px, {{ slide.metadata.elementPositions[titleId].y }}px) !important;"
                                    {% endif %}
                                {% endif %}
                            >{{ slide.props.title }}</h1>
                        {% endif %}
                        {% if slide.props.bullets %}
                            <ul class="bullet-list">
                                {% for bullet in slide.props.bullets %}
                                    {% if bullet and bullet != 'Click to add bullet point' %}
                                    <li class="bullet-item">
                                        <span class="bullet-icon">
                                            {% if slide.props.bulletStyle == 'arrow' %}‚Üí
                                            {% elif slide.props.bulletStyle == 'check' %}‚úì
                                            {% elif slide.props.bulletStyle == 'star' %}‚òÖ
                                            {% elif slide.props.bulletStyle == 'number' %}{{ loop.index }}.
                                            {% else %}‚Ä¢
                                            {% endif %}
                                        </span>
                                        <span class="bullet-text">{{ bullet }}</span>
                                    </li>
                                    {% endif %}
                                {% endfor %}
                            </ul>
                        {% endif %}
                    </div>
                </div>
                
            {% elif slide.templateId == 'big-image-left' %}
                <div class="big-image-left">
                    <div class="image-container">
                        {% if slide.props.imagePath %}
                            <div class="image-positioning-container" style="
                                width: {{ (slide.props.widthPx|string + 'px') if slide.props.widthPx else '500px' }};
                                height: {{ (slide.props.heightPx|string + 'px') if slide.props.heightPx else '350px' }};
                                position: relative;
                                overflow: hidden;
                                border-radius: 8px;
                                {% if slide.metadata and slide.metadata.elementPositions %}
                                    {% set imageId = 'draggable-' + slide.slideId + '-image' %}
                                    {% if slide.metadata.elementPositions[imageId] %}
                                        transform: translate({{ slide.metadata.elementPositions[imageId].x }}px, {{ slide.metadata.elementPositions[imageId].y }}px) !important;
                                    {% endif %}
                                {% endif %}
                            ">
                                <img src="{{ slide.props.imagePath }}" 
                                     alt="Uploaded image" 
                                     class="transformed-image"
                                     style="
                                        width: 100%;
                                        height: 100%;
                                        object-fit: {{ slide.props.objectFit if slide.props.objectFit else 'cover' }};
                                        {% if slide.props.imageOffset %}
                                            {% if slide.props.imageScale and slide.props.imageScale != 1 %}
                                                transform: translate({{ (slide.props.imageOffset.x|string + 'px') if slide.props.imageOffset.x is not none else '0px' }}, {{ (slide.props.imageOffset.y|string + 'px') if slide.props.imageOffset.y is not none else '0px' }}) scale({{ slide.props.imageScale }}) !important;
                                            {% else %}
                                                transform: translate({{ (slide.props.imageOffset.x|string + 'px') if slide.props.imageOffset.x is not none else '0px' }}, {{ (slide.props.imageOffset.y|string + 'px') if slide.props.imageOffset.y is not none else '0px' }}) !important;
                                            {% endif %}
                                            transform-origin: center center !important;
                                        {% endif %}
                                        border-radius: 8px;
                                        margin: 0;
                                        max-width: none;
                                        max-height: none;
                                     "
                                     onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';" />
                            </div>
                            <div class="image-placeholder" style="display: none;">
                                <div style="font-size: 48px; margin-bottom: 16px;">üñºÔ∏è</div>
                                <div style="font-size: 16px; font-weight: bold; margin-bottom: 8px;">Image Placeholder</div>
                                <div style="font-size: 14px; font-style: italic; margin-bottom: 12px;">AI Prompt: "{{ slide.props.imagePrompt or slide.props.imageAlt or 'A high-quality illustration for the topic' }}"</div>
                                <div style="font-size: 12px; color: #868e96;">500px √ó 350px</div>
                            </div>
                        {% else %}
                            <div class="image-placeholder" style="width: 500px; height: 350px; display: flex; align-items: center; justify-content: center; border: 2px dashed #e0e0e0; border-radius: 8px; background-color: #f8f9fa;">
                                <!-- Empty placeholder - maintains layout -->
                            </div>
                        {% endif %}
                    </div>
                    <div class="content-container">
                        {% if slide.props.title and slide.props.title != 'Click to add title' and slide.props.title != 'Add title' %}
                            <h1 class="slide-title positioned-element"
                                {% if slide.metadata and slide.metadata.elementPositions %}
                                    {% set titleId = 'draggable-' + slide.slideId + '-0' %}
                                    {% if slide.metadata.elementPositions[titleId] %}
                                        style="transform: translate({{ slide.metadata.elementPositions[titleId].x }}px, {{ slide.metadata.elementPositions[titleId].y }}px) !important;"
                                    {% endif %}
                                {% endif %}
                            >{{ slide.props.title }}</h1>
                        {% endif %}
                        {% if slide.props.subtitle and slide.props.subtitle != 'Click to add content' and slide.props.subtitle != 'Add subtitle' %}
                            <div class="content-text positioned-element"
                                {% if slide.metadata and slide.metadata.elementPositions %}
                                    {% set subtitleId = 'draggable-' + slide.slideId + '-1' %}
                                    {% if slide.metadata.elementPositions[subtitleId] %}
                                        style="transform: translate({{ slide.metadata.elementPositions[subtitleId].x }}px, {{ slide.metadata.elementPositions[subtitleId].y }}px) !important;"
                                    {% endif %}
                                {% endif %}
                            >{{ slide.props.subtitle }}</div>
                        {% endif %}
                    </div>
                </div>
                
            {% elif slide.templateId == 'big-image-top' %}
                <div class="big-image-top">
                    <div class="image-container">
                        {% if slide.props.imagePath %}
                            <div class="image-positioning-container" style="
                                width: {{ (slide.props.widthPx|string + 'px') if slide.props.widthPx else '100%' }};
                                height: {{ (slide.props.heightPx|string + 'px') if slide.props.heightPx else '240px' }};
                                position: relative;
                                overflow: hidden;
                                border-radius: 8px;
                                margin-bottom: 24px;
                                {% if slide.metadata and slide.metadata.elementPositions %}
                                    {% set imageId = 'draggable-' + slide.slideId + '-image' %}
                                    {% if slide.metadata.elementPositions[imageId] %}
                                        transform: translate({{ slide.metadata.elementPositions[imageId].x }}px, {{ slide.metadata.elementPositions[imageId].y }}px) !important;
                                    {% endif %}
                                {% endif %}
                            ">
                                <img src="{{ slide.props.imagePath }}" 
                                     alt="Uploaded image" 
                                     class="transformed-image"
                                     style="
                                        width: 100%;
                                        height: 100%;
                                        object-fit: {{ slide.props.objectFit if slide.props.objectFit else 'cover' }};
                                        {% if slide.props.imageOffset %}
                                            {% if slide.props.imageScale and slide.props.imageScale != 1 %}
                                                transform: translate({{ (slide.props.imageOffset.x|string + 'px') if slide.props.imageOffset.x is not none else '0px' }}, {{ (slide.props.imageOffset.y|string + 'px') if slide.props.imageOffset.y is not none else '0px' }}) scale({{ slide.props.imageScale }}) !important;
                                            {% else %}
                                                transform: translate({{ (slide.props.imageOffset.x|string + 'px') if slide.props.imageOffset.x is not none else '0px' }}, {{ (slide.props.imageOffset.y|string + 'px') if slide.props.imageOffset.y is not none else '0px' }}) !important;
                                            {% endif %}
                                            transform-origin: center center !important;
                                        {% endif %}
                                        border-radius: 8px;
                                        margin: 0;
                                        max-width: none;
                                        max-height: none;
                                     "
                                     onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';" />
                            </div>
                            <div class="image-placeholder" style="display: none;">
                                <div style="font-size: 48px; margin-bottom: 16px;">üñºÔ∏è</div>
                                <div style="font-size: 16px; font-weight: bold; margin-bottom: 8px;">Image Placeholder</div>
                                <div style="font-size: 14px; font-style: italic; margin-bottom: 12px;">AI Prompt: "{{ slide.props.imagePrompt or slide.props.imageAlt or 'A high-quality illustration for the topic' }}"</div>
                                <div style="font-size: 12px; color: #868e96;">100% √ó 240px</div>
                            </div>
                        {% else %}
                            <div class="image-placeholder" style="width: 100%; height: 240px; display: flex; align-items: center; justify-content: center; border: 2px dashed #e0e0e0; border-radius: 8px; background-color: #f8f9fa; margin-bottom: 24px;">
                                <!-- Empty placeholder - maintains layout -->
                            </div>
                        {% endif %}
                    </div>
                    <div class="content-container">
                        {% if slide.props.title and slide.props.title != 'Click to add title' and slide.props.title != 'Add title' %}
                            <h1 class="slide-title positioned-element"
                                {% if slide.metadata and slide.metadata.elementPositions %}
                                    {% set titleId = 'draggable-' + slide.slideId + '-0' %}
                                    {% if slide.metadata.elementPositions[titleId] %}
                                        style="transform: translate({{ slide.metadata.elementPositions[titleId].x }}px, {{ slide.metadata.elementPositions[titleId].y }}px) !important;"
                                    {% endif %}
                                {% endif %}
                            >{{ slide.props.title }}</h1>
                        {% endif %}
                        {% if slide.props.subtitle and slide.props.subtitle != 'Click to add content' and slide.props.subtitle != 'Add subtitle' %}
                            <div class="content-text positioned-element"
                                {% if slide.metadata and slide.metadata.elementPositions %}
                                    {% set subtitleId = 'draggable-' + slide.slideId + '-1' %}
                                    {% if slide.metadata.elementPositions[subtitleId] %}
                                        style="transform: translate({{ slide.metadata.elementPositions[subtitleId].x }}px, {{ slide.metadata.elementPositions[subtitleId].y }}px) !important;"
                                    {% endif %}
                                {% endif %}
                            >{{ slide.props.subtitle }}</div>
                        {% endif %}
                    </div>
                </div>
                
            {% elif slide.templateId == 'bullet-points-right' %}
                <div class="bullet-points-right">
                    <div class="content-container">
                        {% if slide.props.title and slide.props.title != 'Click to add title' and slide.props.title != 'Add title' %}
                            <h1 class="slide-title positioned-element"
                                {% if slide.metadata and slide.metadata.elementPositions %}
                                    {% set titleId = 'draggable-' + slide.slideId + '-0' %}
                                    {% if slide.metadata.elementPositions[titleId] %}
                                        style="transform: translate({{ slide.metadata.elementPositions[titleId].x }}px, {{ slide.metadata.elementPositions[titleId].y }}px) !important;"
                                    {% endif %}
                                {% endif %}
                            >{{ slide.props.title }}</h1>
                        {% endif %}
                        {% if slide.props.bullets %}
                            <ul class="bullet-list">
                                {% for bullet in slide.props.bullets %}
                                    {% if bullet and bullet != 'Click to add bullet point' %}
                                    <li class="bullet-item">
                                        <span class="bullet-icon">
                                            {% if slide.props.bulletStyle == 'arrow' %}‚Üí
                                            {% elif slide.props.bulletStyle == 'check' %}‚úì
                                            {% elif slide.props.bulletStyle == 'star' %}‚òÖ
                                            {% elif slide.props.bulletStyle == 'number' %}{{ loop.index }}.
                                            {% else %}‚Ä¢
                                            {% endif %}
                                        </span>
                                        <span class="bullet-text">{{ bullet }}</span>
                                    </li>
                                    {% endif %}
                                {% endfor %}
                            </ul>
                        {% endif %}
                    </div>
                    <div class="image-container">
                        {% if slide.props.imagePath %}
                            <img src="{{ slide.props.imagePath }}" 
                                 alt="Uploaded image" 
                                 style="
                                    width: {{ (slide.props.widthPx|string + 'px') if slide.props.widthPx else '100%' }};
                                    height: {{ (slide.props.heightPx|string + 'px') if slide.props.heightPx else '100%' }};
                                    object-fit: {{ slide.props.objectFit if slide.props.objectFit else 'cover' }};
                                    {% if slide.props.imageOffset %}
                                        {% if slide.props.imageScale and slide.props.imageScale != 1 %}
                                            transform: translate({{ (slide.props.imageOffset.x|string + 'px') if slide.props.imageOffset.x is not none else '0px' }}, {{ (slide.props.imageOffset.y|string + 'px') if slide.props.imageOffset.y is not none else '0px' }}) scale({{ slide.props.imageScale }}) !important;
                                        {% else %}
                                            transform: translate({{ (slide.props.imageOffset.x|string + 'px') if slide.props.imageOffset.x is not none else '0px' }}, {{ (slide.props.imageOffset.y|string + 'px') if slide.props.imageOffset.y is not none else '0px' }}) !important;
                                        {% endif %}
                                        transform-origin: center center !important;
                                    {% endif %}
                                    border-radius: 8px; margin: 0 auto;
                                 "
                                 onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';" />
                        {% else %}
                            <div class="placeholder" style="width: 320px; height: 320px; display: flex; align-items: center; justify-content: center; border: 2px dashed #e0e0e0; border-radius: 8px; background-color: #f8f9fa;">
                                <!-- Empty placeholder - maintains layout -->
                            </div>
                        {% endif %}
                    </div>
                </div>
                
            {% elif slide.templateId == 'two-column' %}
                <div class="two-column">
                    <div class="column">
                        {% if slide.props.leftImagePath %}
                            <img src="{{ slide.props.leftImagePath }}" 
                                 alt="Uploaded image" 
                                 style="
                                    width: {{ (slide.props.leftWidthPx|string + 'px') if slide.props.leftWidthPx else '100%' }};
                                    height: {{ (slide.props.leftHeightPx|string + 'px') if slide.props.leftHeightPx else '200px' }};
                                    max-width: {{ (slide.props.leftWidthPx|string + 'px') if slide.props.leftWidthPx else '320px' }};
                                    max-height: {{ (slide.props.leftHeightPx|string + 'px') if slide.props.leftHeightPx else '200px' }};
                                    object-fit: {{ slide.props.leftObjectFit if slide.props.leftObjectFit else 'cover' }};
                                    {% if slide.props.leftImageOffset %}
                                        {% if slide.props.leftImageScale and slide.props.leftImageScale != 1 %}
                                            transform: translate({{ (slide.props.leftImageOffset.x|string + 'px') if slide.props.leftImageOffset.x is not none else '0px' }}, {{ (slide.props.leftImageOffset.y|string + 'px') if slide.props.leftImageOffset.y is not none else '0px' }}) scale({{ slide.props.leftImageScale }}) !important;
                                        {% else %}
                                            transform: translate({{ (slide.props.leftImageOffset.x|string + 'px') if slide.props.leftImageOffset.x is not none else '0px' }}, {{ (slide.props.leftImageOffset.y|string + 'px') if slide.props.leftImageOffset.y is not none else '0px' }}) !important;
                                        {% endif %}
                                        transform-origin: center center !important;
                                    {% endif %}
                                    margin: 0; margin-bottom: 24px !important; border-radius: 8px;
                                 "
                                 onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';" />
                        {% else %}
                            <div class="placeholder" style="width: 100%; max-height: 200px; max-width: 320px; height: 200px; display: flex; align-items: center; justify-content: center; border: 2px dashed #e0e0e0; border-radius: 8px; background-color: #f8f9fa; margin-bottom: 24px;">
                                <!-- Empty placeholder - maintains layout -->
                            </div>
                        {% endif %}
                        {% if slide.props.leftTitle and slide.props.leftTitle != 'Click to add left title' %}
                            <h2 class="column-title positioned-element"
                                {% if slide.metadata and slide.metadata.elementPositions %}
                                    {% set leftTitleId = 'draggable-' + slide.slideId + '-1' %}
                                    {% if slide.metadata.elementPositions[leftTitleId] %}
                                        style="transform: translate({{ slide.metadata.elementPositions[leftTitleId].x }}px, {{ slide.metadata.elementPositions[leftTitleId].y }}px) !important;"
                                    {% endif %}
                                {% endif %}
                            >{{ slide.props.leftTitle }}</h2>
                        {% endif %}
                        {% if slide.props.leftContent and slide.props.leftContent != 'Click to add left content' %}
                            <p class="column-content positioned-element"
                                {% if slide.metadata and slide.metadata.elementPositions %}
                                    {% set leftContentId = 'draggable-' + slide.slideId + '-2' %}
                                    {% if slide.metadata.elementPositions[leftContentId] %}
                                        style="transform: translate({{ slide.metadata.elementPositions[leftContentId].x }}px, {{ slide.metadata.elementPositions[leftContentId].y }}px) !important;"
                                    {% endif %}
                                {% endif %}
                            >{{ slide.props.leftContent }}</p>
                        {% endif %}
                    </div>
                    <div class="column">
                        {% if slide.props.rightImagePath %}
                            <img src="{{ slide.props.rightImagePath }}" 
                                 alt="Uploaded image" 
                                 style="
                                    width: {{ (slide.props.rightWidthPx|string + 'px') if slide.props.rightWidthPx else '100%' }};
                                    height: {{ (slide.props.rightHeightPx|string + 'px') if slide.props.rightHeightPx else '200px' }};
                                    max-width: {{ (slide.props.rightWidthPx|string + 'px') if slide.props.rightWidthPx else '320px' }};
                                    max-height: {{ (slide.props.rightHeightPx|string + 'px') if slide.props.rightHeightPx else '200px' }};
                                    object-fit: {{ slide.props.rightObjectFit if slide.props.rightObjectFit else 'cover' }};
                                    {% if slide.props.rightImageOffset %}
                                        {% if slide.props.rightImageScale and slide.props.rightImageScale != 1 %}
                                            transform: translate({{ (slide.props.rightImageOffset.x|string + 'px') if slide.props.rightImageOffset.x is not none else '0px' }}, {{ (slide.props.rightImageOffset.y|string + 'px') if slide.props.rightImageOffset.y is not none else '0px' }}) scale({{ slide.props.rightImageScale }}) !important;
                                        {% else %}
                                            transform: translate({{ (slide.props.rightImageOffset.x|string + 'px') if slide.props.rightImageOffset.x is not none else '0px' }}, {{ (slide.props.rightImageOffset.y|string + 'px') if slide.props.rightImageOffset.y is not none else '0px' }}) !important;
                                        {% endif %}
                                        transform-origin: center center !important;
                                    {% endif %}
                                    margin: 0; margin-bottom: 24px !important; border-radius: 8px;
                                 "
                                 onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';" />
                        {% else %}
                            <div class="placeholder" style="width: 100%; max-height: 200px; max-width: 320px; height: 200px; display: flex; align-items: center; justify-content: center; border: 2px dashed #e0e0e0; border-radius: 8px; background-color: #f8f9fa; margin-bottom: 24px;">
                                <!-- Empty placeholder - maintains layout -->
                            </div>
                        {% endif %}
                        {% if slide.props.rightTitle and slide.props.rightTitle != 'Click to add right title' %}
                            <h2 class="column-title positioned-element"
                                {% if slide.metadata and slide.metadata.elementPositions %}
                                    {% set rightTitleId = 'draggable-' + slide.slideId + '-3' %}
                                    {% if slide.metadata.elementPositions[rightTitleId] %}
                                        style="transform: translate({{ slide.metadata.elementPositions[rightTitleId].x }}px, {{ slide.metadata.elementPositions[rightTitleId].y }}px) !important;"
                                    {% endif %}
                                {% endif %}
                            >{{ slide.props.rightTitle }}</h2>
                        {% endif %}
                        {% if slide.props.rightContent and slide.props.rightContent != 'Click to add right content' %}
                            <p class="column-content positioned-element"
                                {% if slide.metadata and slide.metadata.elementPositions %}
                                    {% set rightContentId = 'draggable-' + slide.slideId + '-4' %}
                                    {% if slide.metadata.elementPositions[rightContentId] %}
                                        style="transform: translate({{ slide.metadata.elementPositions[rightContentId].x }}px, {{ slide.metadata.elementPositions[rightContentId].y }}px) !important;"
                                    {% endif %}
                                {% endif %}
                            >{{ slide.props.rightContent }}</p>
                        {% endif %}
                    </div>
                </div>
                
            {% else %}
                <!-- Default template for any other templateId -->
                <div class="default-slide">
                    {% if slide.props.title and slide.props.title != 'Click to add title' %}
                        <h1 class="slide-title positioned-element"
                            {% if slide.metadata and slide.metadata.elementPositions %}
                                {% set titleId = 'draggable-' + slide.slideId + '-0' %}
                                {% if slide.metadata.elementPositions[titleId] %}
                                    style="transform: translate({{ slide.metadata.elementPositions[titleId].x }}px, {{ slide.metadata.elementPositions[titleId].y }}px) !important;"
                                {% endif %}
                            {% endif %}
                        >{{ slide.props.title }}</h1>
                    {% endif %}
                    {% if slide.props.content and slide.props.content != 'Click to add content' %}
                        <div class="slide-content positioned-element"
                            {% if slide.metadata and slide.metadata.elementPositions %}
                                {% set contentId = 'draggable-' + slide.slideId + '-1' %}
                                {% if slide.metadata.elementPositions[contentId] %}
                                    style="transform: translate({{ slide.metadata.elementPositions[contentId].x }}px, {{ slide.metadata.elementPositions[contentId].y }}px) !important;"
                                {% endif %}
                            {% endif %}
                        >{{ slide.props.content }}</div>
                    {% endif %}
                </div>
            {% endif %}
        </div>
    </div>
</body>
</html>
